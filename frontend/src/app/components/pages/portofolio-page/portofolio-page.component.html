
<div class="list-container">
  <div class="row h-100" >
    <div class="col-md-4 d-flex flex-column p-2 " >
      <div class="accordion" id="accordionExample">
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
              Invest
            </button>
          </h2>
          <div id="collapseOne" class="accordion-collapse collapse show" data-bs-parent="#accordionExample">
            <div class="accordion-body">
              <div *ngFor="let item of getStocks()" class="stock-card">
                <div *ngIf="item.type==='stock'">
                <div class="stock-name"><a routerLink="/stock/{{item.symbolId}}">{{ item.symbol }}</a></div>
                <div class="stock-amount">{{ item.nrOfActions | number: '1.2-2' }} actions</div>
                <div class="stock-value">{{ item.currentValue | currency:'USD':'symbol-narrow' }}</div>
                <div class="stock-change" [ngClass]="{'positive': item.percentChange >= 0, 'negative': item.percentChange < 0}">
                  {{ item.percentChange | number:'1.2-2' }}%
                </div>
                <button type="button" class="btn btn-danger" (click)="openSellModal(item)">Vinde</button>
              </div>
              </div>
            </div>
          </div>
        </div>
        <div class="accordion-item">
          <h2 class="accordion-header">
            <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
              CFD
            </button>
          </h2>
          <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionExample">
            <div *ngFor="let item of getCryptos()" class="stock-card">
              <div *ngIf="item.type==='crypto'">
              <div class="stock-name"><a routerLink="/crypto/{{item.symbolId}}">{{item.symbol}}</a></div>
              <div class="stock-amount">{{ item.nrOfActions | number: '1.2-2' }} coins</div>
              <div class="stock-value">{{ item.currentValue | currency:'USD':'symbol-narrow' }}</div>
              <div class="stock-change" [ngClass]="{'positive': item.percentChange >= 0, 'negative': item.percentChange < 0}">
                {{ item.percentChange | number:'1.2-2' }}%
              </div>
              <button type="button" class="btn btn-danger" (click)="openSellModal(item)">Vinde</button>
            </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Chart Container -->
    <div class="chart-container" style="flex: 2;">
      <highcharts-chart *ngIf="showChart"
        [Highcharts]="Highcharts"
        [options]="chartOptions"
        style="width: 100%; height: 400px; display: block;">
      </highcharts-chart>
    </div>
    </div>
    <div class="col-md-8 d-flex flex-column p-2">
      <div class="flex-grow-1 overflow-auto">
        <div class="overview-container" style="display: flex; justify-content: space-between;">
          <!-- Details Container -->
          <div class="details-container" style="flex: 1;">
            <div class="account-value">
              <div class="label">Account Amount</div>
              <div class="value">{{ user.balance | currency: 'USD':'symbol-narrow' }}</div>
            </div>
            <div class="portfolio-value">
              <div class="label">Portfolio Value</div>
              <div class="value">{{ portfolioValue | currency: 'USD':'symbol-narrow' }}</div>
            </div>
            <button type="button" *ngIf="!showChart" class="btn btn-primary" (click)="loadChartData()">Show statistics</button>
            <button type="button" *ngIf="showChart" class="btn btn-primary" (click)="hideStats()">Hide statistics</button>
          </div> 
      </div> 
      <div class="history-container">
        <div class="order-history">
          <h2>Istoric Comenzi</h2>
          <div *ngFor="let order of purchaseOrders | slice:0:displayLimit" class="order-detail">
            <div>Data: {{ order.date | date: 'medium' }}</div>
            <div>Simbol: {{ order.symbol }}</div>
            <div>Preț per acțiune: {{ order.price | currency: 'USD' }}</div>
            <div>Număr acțiuni: {{ order.nrOfActions }}</div>
            <div>Valoare totală: {{ (order.price * order.nrOfActions) | currency: 'USD' }}</div>
            <div>Status: {{ order.status }}</div>
          </div>
          <button *ngIf="displayLimit < purchaseOrders.length" (click)="showMore()" class="btn btn-primary">Show More</button>
        </div>
      </div>
  </div>
    
  </div>
  </div>
</div>

<ng-template #sellModal let-modal>
  <div class="modal-header">
    <h5 class="modal-title">Vânzare {{ selectedStock?.symbol }}</h5>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <form>
      <div class="form-group">
        <label for="sellAmount">Număr disponibil de actiuni:{{ selectedStock?.nrOfActions }}</label>
        <label for="sellAmount">Număr de acțiuni:</label>
        <input type="number" class="form-control" id="sellAmount" [(ngModel)]="sellAmount" name="sellAmount" required>
      </div>
      <div>
        Valoare totală estimată: {{ sellAmount * selectedStock?.currentPrice | currency:'USD':'symbol-narrow' }}
      </div>
    </form>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" (click)="modal.close('Close click')">Închide</button>
    <button type="button" class="btn btn-primary" (click)="sellStock()">Confirmă vânzarea</button>
  </div>
</ng-template>



